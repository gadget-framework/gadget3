<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gadget3 likelihood actions — likelihood_catchdistribution • gadget3</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Gadget3 likelihood actions — likelihood_catchdistribution" />
<meta property="og:description" content="Gather nll in a g3 model" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gadget3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/model-debugging.html">Debugging a gadget3 model</a>
    </li>
    <li>
      <a href="../articles/model_structure.html">Structure of a gadget3 model</a>
    </li>
    <li>
      <a href="../articles/tmb-gotchas.html">Gotchas and quirks of TMB</a>
    </li>
    <li>
      <a href="../articles/writing_actions.html">Writing G3 Actions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gadget3 likelihood actions</h1>
    
    <div class="hidden name"><code>likelihood_distribution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gather nll in a g3 model</p>
    </div>

    <pre class="usage"><span class='fu'>g3l_distribution_sumofsquares</span><span class='op'>(</span>over <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"area"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>g3l_distribution_multinomial</span><span class='op'>(</span>epsilon <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='fu'>g3l_distribution_multivariate</span><span class='op'>(</span><span class='va'>rho_f</span>, <span class='va'>sigma_f</span>, over <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"area"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>g3l_distribution_surveyindices_log</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='cn'>NULL</span>, beta <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>g3l_distribution_surveyindices_linear</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='cn'>NULL</span>, beta <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>g3l_distribution</span><span class='op'>(</span><span class='va'>nll_name</span>, <span class='va'>obs_data</span>, fleets <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>stocks</span>, <span class='va'>function_f</span>,
    missing_val <span class='op'>=</span> <span class='fl'>0</span>, area_group <span class='op'>=</span> <span class='cn'>NULL</span>, report <span class='op'>=</span> <span class='cn'>FALSE</span>, nll_breakdown <span class='op'>=</span> <span class='cn'>FALSE</span>,
    weight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span><span class='op'>(</span><span class='fu'><a href='language.html'>g3_param</a></span><span class='op'>(</span><span class='va'>n</span>, optimise <span class='op'>=</span> <span class='cn'>FALSE</span>, value <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>nll_name</span>, <span class='st'>"_weight"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
    run_at <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='fu'>g3l_catchdistribution</span><span class='op'>(</span><span class='va'>nll_name</span>, <span class='va'>obs_data</span>, <span class='va'>fleets</span>, <span class='va'>stocks</span>, <span class='va'>function_f</span>, missing_val <span class='op'>=</span> <span class='fl'>0</span>, 
    area_group <span class='op'>=</span> <span class='cn'>NULL</span>, report <span class='op'>=</span> <span class='cn'>FALSE</span>, nll_breakdown <span class='op'>=</span> <span class='cn'>FALSE</span>,
    weight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span><span class='op'>(</span><span class='fu'><a href='language.html'>g3_param</a></span><span class='op'>(</span><span class='va'>n</span>, optimise <span class='op'>=</span> <span class='cn'>FALSE</span>, value <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>nll_name</span>, <span class='st'>"_weight"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
    run_at <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>over</th>
      <td><p>When comparing proportions of lengthgroups, specifies the dimensions that define the total.
    For example the default "area" means the proprtion of the current lengthgroup to all individuals
    in that area.</p></td>
    </tr>
    <tr>
      <th>rho_f</th>
      <td><p><a href='https://rdrr.io/r/stats/formula.html'>formula</a> substituted into multivariate calcuations, see below.</p></td>
    </tr>
    <tr>
      <th>sigma_f</th>
      <td><p><a href='https://rdrr.io/r/stats/formula.html'>formula</a> substituted into multivariate calcuations, see below.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>Value to be used whenever the calculated probability is very unlikely. Default 10.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p><a href='https://rdrr.io/r/stats/formula.html'>formula</a> substituted into surveyindices calcuations to fix intercept of linear regression,
    or NULL if not fixed. See below.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p><a href='https://rdrr.io/r/stats/formula.html'>formula</a> substituted into surveyindices calcuations to fix slope of linear regression,
    or NULL if not fixed. See below.</p></td>
    </tr>
    <tr>
      <th>nll_name</th>
      <td><p>Character string, used to define the variable name for <var>obsstock</var> and <var>modelstock</var>.</p></td>
    </tr>
    <tr>
      <th>obs_data</th>
      <td><p>Data.frame of observation data, for example the results of
    mfdb_sample_count.</p>
<p>Should at least have a year column, and a length or weight column.
    For more information, see "obs_data and data aggregation" below.</p></td>
    </tr>
    <tr>
      <th>fleets</th>
      <td><p>A list of <code><a href='stock.html'>g3_stock</a></code> objects to collect catch data for.
    If empty, will collect abundance data for <var>stocks</var> instead.</p></td>
    </tr>
    <tr>
      <th>stocks</th>
      <td><p>A list of <code><a href='stock.html'>g3_stock</a></code> objects to collect catch or abundance data for,
    depending if <var>stocks</var> were provided.</p></td>
    </tr>
    <tr>
      <th>function_f</th>
      <td><p>A <a href='https://rdrr.io/r/stats/formula.html'>formula</a> to compare <var>obsstock__x</var> to <var>modelstock__x</var> and generate nll,
    defined by one of the <var>g3l_distribution_</var>* functions.</p>
<p>This will be adapted to compare either number (<var>modelstock__num</var>) or weight (<var>modelstock__wgt</var>)
    depending on what columns <var>obs_data</var> has.</p></td>
    </tr>
    <tr>
      <th>missing_val</th>
      <td><p>Where there are missing values in the incoming data, value to replace them with.</p></td>
    </tr>
    <tr>
      <th>area_group</th>
      <td><p>mfdb_group or list mapping area names used in
    <var>obs_data</var> to integer model areas, see "obs_data and data aggregation"
    below.</p></td>
    </tr>
    <tr>
      <th>report</th>
      <td><p>If TRUE, add model and observation arrays to the model report, called
    <code>cdist_<var>nll_name</var>_model__num/wgt</code> and <code>cdist_<var>nll_name</var>_obs__num/wgt</code>
    respectively</p></td>
    </tr>
    <tr>
      <th>nll_breakdown</th>
      <td><p>Should the nll report be broken down by time? <code>TRUE</code> / <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>weight</th>
      <td><p>Weighting applied to this likelihood component. Default is a <code>g3_param</code>
    that defaults to 1, allowing weights to be altered without recompiling.</p></td>
    </tr>
    <tr>
      <th>run_at</th>
      <td><p>Integer order that actions will be run within model, see "Ordering of actions" in <code><a href='../articles/model_structure.html'>vignette("model_structure")</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The actions will define the following variables in your model:</p><dl>
    <dt><var>obsstock</var>__num/wgt</dt><dd><p>A <code><a href='stock.html'>g3_stock</a></code> instance that contains all observations in an array</p></dd>
    <dt><var>modelstock</var>__num/wgt</dt><dd><p>A <code><a href='stock.html'>g3_stock</a></code> instance that groups in an identical fashion to <var>obsstock</var>,
        that will be filled with the model's predicted values</p></dd>
  
</dl>

<p>The model report will contain nll_cdist_<var>nll_name</var>__num and/or nll_cdist_<var>nll_name</var>__wgt, depending on
  the columns in <var>obs_data</var> (a number column will compare by individuals, and produce a corresponding num report).
  If <var>nll_breakdown</var> is <code>TRUE</code>, this will be an array with one entry per timestep.</p>
<p>The only difference between <var>g3l_distribution</var> and <var>g3l_catchdistribution</var> is the latter insists that at least one fleet
  is provided, so it can compare catch rather than abundance.</p>
<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>obs_data and data aggregation</h3>
<p>The <var>obs_data</var> data.frame, as well as providing the observation data to
    compare the model data against, controls the grouping of model data to
    compare to the observation data, by inspecting the MFDB column attributes
    produced by e.g. mfdb_sample_count.</p>
<p>Metadata columns describe the observation datapoint in that row. The
    columns should be from this list:</p><dl>
      <dt>year</dt><dd><p>Required.
        Year for the data point. Gaps in years will result in no comparison for that year</p></dd>
      <dt>step</dt><dd><p>Optional.
        If there is no step column, then the data is assumed to be yearly, and
        the model data for all timesteps will be summed before comparing.        Model timestep for the data point. Gaps in steps will result in no comparison for that year/step.</p></dd>
      <dt>length</dt><dd><p>Optional.
        If missing all lengthgroups in the model will be summed to compare to
        the data.        If <code>open_ended = c('lower', 'upper')</code> was used when querying MFDB
        for the data, then the bottom/top length groups will be modified to
        start from zero or be infinite respectively.        Any missing lengthgroups (when there is otherwise data for that
        year/step) will be compared to zero.</p></dd>
      <dt>age</dt><dd><p>Optional.
        If missing all age-groups (if any) in the model will be summed to compare to
        the data.        Model ages will be grouped by the same groupings as MFDB used, thus if
        the data was formed with a query <code>age = mfdb_group(young = 1:3,
        old = 4:5)</code>, then the model data will similarly have 2 groups in it.        Any missing ages (when there is otherwise data for that
        year/step) will be compared to zero.</p></dd>
      <dt>stock</dt><dd><p>Optional.
        If missing all stocks in <var>stocks</var> will be summed to compare to the
        data.        The values in the stocks column should match the names of the stocks
        given in the <var>stocks</var> parameter. This column can be factor or
        character.        Any missing stocks (when there is otherwise data for that
        year/step) will be compared to zero.</p></dd>
      <dt>area</dt><dd><p>Optional.
        If missing all areas in the model will be summed to compare to
        the data.        Unlike other columns, the MFDB grouping here is ignored (the areas it
        is grouping over aren't integer model areas). Instead, the
        <var>area_group</var> parameter should describe how to map from the area
        names used in the table to integer model areas.        For example, if <code>area_group = list(north=1:2, south=3:5)</code>, then
        the area column of <var>obs_data</var> should contain either "north" or
        "south", and corresponding model data will be summed from integer model
        areas 1,2 and 3,4,5 respectively.        If <var>area_group</var> is not supplied, then we assume that <var>obs_data</var>
        area column will contain model area integers.        Any missing areas (when there is otherwise data for that
        year/step) will be compared to zero.</p></dd>
    
</dl>

<p>Data columns contain the observation data to compare. There should be at
    least one of:</p>
<p></p><dl>
      <dt>number</dt><dd><p>If a number column appears in <var>obs_data</var>, then the stock abundance
        by individuals will be aggregated and compared to the <var>obs_data</var>
        number column.</p></dd>
      <dt>weight</dt><dd><p>If a weight column appears in <var>obs_data</var>, then the total biomass of
        the stock will be aggregated and compared to the <var>obs_data</var> number
        column.</p></dd>
    
</dl><p></p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://gadget-framework.github.io/gadget2/userguide/chap-like.html'>https://gadget-framework.github.io/gadget2/userguide/chap-like.html</a>,
  <code><a href='stock.html'>g3_stock</a></code></p></div>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution_sumofsquares</h3>
<p>Returns a <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for use as <var>function_f</var>:</p>
<p>$$ \sum_{\it lengths} \Big( \frac{N_{tral}}{N_{tr}} - \frac{\nu_{tral}}{\nu_{tr}}  \Big) ^2 $$</p><dl>
      <dt>\(N_{tral}\)</dt><dd><p>Observation sample size for current time/area/age/length combination</p></dd>
      <dt>\(\nu_{tral}\)</dt><dd><p>Model sample size for current time/area/age/length combination</p></dd>
      <dt>\(N_{tr}\)</dt><dd><p>Total observation sample size for current time/area (or dimensions set in <var>over</var>)</p></dd>
      <dt>\(\nu_{tr}\)</dt><dd><p>Total model sample size for current time/area (or dimensions set in <var>over</var>)</p></dd>
    
</dl><p></p>

<p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution_multinomial</h3>
<p>Returns a <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for use as <var>function_f</var>:</p>
<p>$$
      2 (
        \sum_{\it lengths} \log N_{tral}! -
        \log (\sum_{\it lengths} N_{tral})! -
        \sum_{\it lengths} ( N_{tral} \log min(\frac{\nu_{tral}}{\sum_{\it lengths} \nu_{tral}}, \frac{1}{l \epsilon}) )
      )
    $$</p>    
<p></p><dl>
      <dt>\(N_{tral}\)</dt><dd><p>Observation sample size for current time/area/age/length combination</p></dd>
      <dt>\(\nu_{tral}\)</dt><dd><p>Model sample size for current time/area/age/length combination</p></dd>
      <dt>\(l\)</dt><dd><p>Number of lengthgroups in sample</p></dd>
      <dt>\(\epsilon\)</dt><dd><p><var>epsilon</var> parameter</p></dd>
    
</dl><p></p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution_multivariate</h3>
<p>Returns a <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for use as <var>function_f</var>, which calls TMB's <code>SCALE(AR1(rho), sigma)(x)</code>, where
    <var>rho</var> and <var>sigma</var> are parameters, and <code>x</code> is defined as:</p>
<p>$$ \frac{N_{tral}}{N_{tr}} - \frac{\nu_{tral}}{\nu_{tr}} $$</p><dl>
      <dt>\(N_{tral}\)</dt><dd><p>Observation sample size for current time/area/age/length combination</p></dd>
      <dt>\(\nu_{tral}\)</dt><dd><p>Model sample size for current time/area/age/length combination</p></dd>
      <dt>\(N_{tr}\)</dt><dd><p>Total observation sample size for current time/area (or dimensions set in <var>over</var>)</p></dd>
      <dt>\(\nu_{tr}\)</dt><dd><p>Total model sample size for current time/area (or dimensions set in <var>over</var>)</p></dd>
    
</dl><p>For more information, see <a href='Autoregressive processes'>http://kaskr.github.io/adcomp/_book/Densities.html#autoregressive-processes</a>
    in the TMB book.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution_surveyindices_log</h3>
<p>Returns a <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for use as <var>function_f</var>:</p>
<p>$$
      \sum_{\it time} (\alpha + \beta \log N_{tral} - \log \nu_{tral})^2
    $$</p><dl>
      <dt>\(N_{tral}\)</dt><dd><p>Observation sample size for current time/area/age/length combination</p></dd>
      <dt>\(\nu_{tral}\)</dt><dd><p>Model sample size for current time/area/age/length combination</p></dd>
      <dt>\(\alpha\)</dt><dd><p><var>alpha</var> parameter</p></dd>
      <dt>\(\beta\)</dt><dd><p><var>beta</var> parameter</p></dd>
    
</dl>

<p>If <var>alpha</var> or <var>beta</var> is not provided, then linear regression is
    performed on \(N\), \(\nu\) over time for each area/age/length combination.
    The used values will be stored in a <code>cdist_<var>nll_name</var>_model__param</code> array and
    reported after model run, whether calculated or hard-coded.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution_surveyindices_linear</h3>
<p>Returns a <a href='https://rdrr.io/r/stats/formula.html'>formula</a> for use as <var>function_f</var>:</p>
<p>$$
      \sum_{\it lengths} (\alpha + \beta N_{tral} - \nu_{tral})^2
    $$</p><dl>
      <dt>\(N_{tral}\)</dt><dd><p>Observation sample size for current time/area/age/length combination</p></dd>
      <dt>\(\nu_{tral}\)</dt><dd><p>Model sample size for current time/area/age/length combination</p></dd>
      <dt>\(\alpha\)</dt><dd><p><var>alpha</var> parameter</p></dd>
      <dt>\(\beta\)</dt><dd><p><var>beta</var> parameter</p></dd>
    
</dl>

<p>If <var>alpha</var> or <var>beta</var> is not provided, then linear regression is
    performed on \(N\), \(\nu\) over time for each area/age/length combination.
    The used values will be stored in a <code>cdist_<var>nll_name</var>_model__param</code> array and
    reported after model run, whether calculated or hard-coded.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_distribution</h3>
<p>Assuming <var>fleets</var> is empty, an action (i.e. list of formula objects) that will...</p><ol>
<li><p>For all <var>stocks</var>, collect catch data into <var>modelstock</var>__num or <var>modelstock</var>__wgt, depending on the columns provided in <var>obs_data</var></p></li>
<li><p>Compare <var>modelstock</var>__num/wgt with <var>obsstock</var>__num/wgt, using <var>function_f</var></p></li>
</ol><p>The output of <var>function_f</var> is summed over all stock dimensions (age/area) and time and added to <code>nll</code>.</p><p></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>g3l_catchdistribution</h3>
<p>An action (i.e. list of formula objects) that will...</p><ol>
<li><p>For all <var>fleets</var> and <var>stocks</var> combinations, collect catch data into <var>modelstock</var>__num or <var>modelstock</var>__wgt, depending on the columns provided in <var>obs_data</var></p></li>
<li><p>Compare <var>modelstock</var>__num/wgt with <var>obsstock</var>__num/wgt, using <var>function_f</var></p></li>
</ol><p>The output of <var>function_f</var> is summed over all stock dimensions (age/area) and time and added to <code>nll</code>.</p>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
<span class='va'>ling_imm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='stock.html'>g3_stock</a></span><span class='op'>(</span><span class='st'>'ling_imm'</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>156</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='stock_age.html'>g3s_age</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>ling_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='stock.html'>g3_stock</a></span><span class='op'>(</span><span class='st'>'ling_mat'</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>156</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='stock_age.html'>g3s_age</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>15</span><span class='op'>)</span>
<span class='va'>lln</span> <span class='op'>&lt;-</span> <span class='fu'><a href='stock.html'>g3_fleet</a></span><span class='op'>(</span><span class='st'>'lln'</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># Fetch length distribution via. MFDB</span>
<span class='va'>ldist.lln</span> <span class='op'>&lt;-</span> <span class='fu'>mfdb_sample_count</span><span class='op'>(</span><span class='va'>mdb</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'age'</span>, <span class='st'>'length'</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    sampling_type <span class='op'>=</span> <span class='st'>'SEA'</span>,
    data_source <span class='op'>=</span> <span class='st'>'iceland-ldist'</span>,
    gear <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'LLN'</span>,<span class='st'>'HLN'</span><span class='op'>)</span>,
    age <span class='op'>=</span> <span class='fu'>mfdb_interval</span><span class='op'>(</span><span class='st'>"all"</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minage</span>, <span class='va'>maxage</span><span class='op'>)</span>,
        open_ended <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"upper"</span>,<span class='st'>"lower"</span><span class='op'>)</span><span class='op'>)</span>,
    length <span class='op'>=</span> <span class='fu'>mfdb_interval</span><span class='op'>(</span><span class='st'>"len"</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>minlength</span>, <span class='va'>maxlength</span>, by <span class='op'>=</span> <span class='va'>dl</span><span class='op'>)</span>,
        open_ended <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"upper"</span>,<span class='st'>"lower"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>defaults</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Invent a ldist.lln table for our tests</span>
<span class='va'>ldist.lln</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span>
    year <span class='op'>=</span> <span class='fl'>1999</span><span class='op'>:</span><span class='fl'>2000</span>,
    step <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
    age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ldist.lln</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>number</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ldist.lln</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>, min<span class='op'>=</span><span class='fl'>100</span>, max<span class='op'>=</span><span class='fl'>999</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>likelihood_actions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  <span class='fu'>g3l_catchdistribution</span><span class='op'>(</span>
    <span class='st'>'ldist_lln'</span>,
    <span class='va'>ldist.lln</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,
    fleets <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>lln</span><span class='op'>)</span>,
    stocks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>ling_imm</span>, <span class='va'>ling_mat</span><span class='op'>)</span>,
    <span class='fu'>g3l_distribution_sumofsquares</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jamie Lentin, Bjarki Thor Elvarsson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


